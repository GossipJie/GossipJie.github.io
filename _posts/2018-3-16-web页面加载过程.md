---
layout: post
title:  "web页面加载过程"
categories: share
---

### 一个页面从输入URL到页面加载显示完成，这个过程中发生了什么？

#### 考察角度
根据擅长领域自由发挥，从url规范、http协议、DNS、数据库查询、到浏览器流式解析、css规则重构、layout、paint、onload/domready、js执行、JS API绑定等等。

#### 详细版
1. 浏览器会开启一个线程来处理这个请求，对url分析判断如果是http协议就按照web方式处理；
1. 调用浏览器内核中对应的方法，比如webview中的loadURL方法；
1. 通过域名解析获取域名的IP地址，设置ua等信息发出第二个get请求；
1. 进入http协议会话，客户端发送请求报头；
1. 进入web服务器上的web server，如Apache、tomcat、nodejs等服务器；
1. 进入部署好的后端应用，找到对应的请求处理；
1. 处理结束，回馈报头，此处如果浏览器访问过，缓存上有对应资源，会与服务器最后修改时间对比、一致则返回304；
1. 浏览器开始下载HTML文档（相应报头，状态码200），同时使用缓存；
1. 文档书建立，根据标记请求所需制定mime类型的文件（比如css,js),同时设置cookie；
1. 页面开始渲染dom,js根据DOM API操作DOM，执行事件绑定，页面显示完后。
#### 简单版
- 浏览器根据请求的url交给DNS域名解析，找到真实ip，向服务器发起请求；
- 服务器交给后台处理完成后返回数据，浏览器接受文件（HTML、js、css、图像等）；
- 浏览器对加载到的资源进行语法解析，建立相应的内部数据结构；
载入解析到的资源文件，渲染页面，完成。

### DNS域名解析过程